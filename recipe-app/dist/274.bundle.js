"use strict";(self.webpackChunkrecipe_app=self.webpackChunkrecipe_app||[]).push([[274],{4126:(e,r,t)=>{t.d(r,{D:()=>o});var o=[{value:"breakfast",label:"Завтрак"},{value:"lunch",label:"Обед"},{value:"dinner",label:"Ужин"},{value:"other",label:"Другое"}]},5278:e=>{e.exports="data:image/svg+xml;utf8,<svg fill=%27white%27 height=%2724%27 viewBox=%270 0 24 24%27 width=%2724%27 xmlns=%27http://www.w3.org/2000/svg%27><path d=%27M7 10l5 5 5-5z%27/></svg>"},6950:(e,r,t)=>{t.d(r,{A:()=>l});var o=t(1601),n=t.n(o),i=t(6314),a=t.n(i)()(n());a.push([e.id,".new-recipe-page{max-width:1200px;margin:0 auto;padding:2rem}.new-recipe-page h2{margin-bottom:1.5rem;color:#2c7ac8;cursor:default}",""]);const l=a},7272:(e,r,t)=>{t.d(r,{A:()=>d});var o=t(1601),n=t.n(o),i=t(6314),a=t.n(i),l=t(4417),c=t.n(l),u=new URL(t(5278),t.b),s=a()(n()),p=c()(u);s.push([e.id,`.recipe-form{max-width:800px;margin:0 auto;padding:2rem;background-color:rgba(0,0,0,.65);border-radius:8px}.recipe-form input,.recipe-form textarea,.recipe-form select{user-select:text;color:#fff}.recipe-form .form-group{margin-bottom:1.5rem}.recipe-form .form-group label{display:block;margin-bottom:.5rem;font-weight:bold;cursor:default}.recipe-form .form-group input[type=text],.recipe-form .form-group input[type=number],.recipe-form .form-group select{width:100%;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;transition:border-color .3s ease,background-color .3s ease}.recipe-form .form-group input[type=number]{appearance:none;-webkit-appearance:none;-moz-appearance:textfield}.recipe-form .form-group select{background-color:rgba(0,0,0,.65);font-family:inherit}.recipe-form .form-group select:focus,.recipe-form .form-group input:focus,.recipe-form .form-group textarea:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%);background-color:hsla(0,0%,100%,.15)}.recipe-form .recipe-description{margin-top:-1rem;margin-bottom:1.5rem;font-size:1rem;color:hsl(0,0%,130%);line-height:1.6;opacity:.9}.recipe-form .steps-container{margin:2rem 0}.recipe-form .step{background-color:rgba(0,0,0,.5);padding:1rem;border-radius:4px;margin-bottom:1rem;position:relative;transition:all .3s ease}.recipe-form .step:hover{background-color:rgba(0,0,0,.65)}.recipe-form .step-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.recipe-form .step-header h4{margin:0;font-size:1rem;font-weight:bold}.recipe-form .step-header .remove-step{background-color:#ff4d4d;border:none;padding:.25rem .5rem;border-radius:4px;cursor:pointer;font-size:.9rem;transition:background-color .3s}.recipe-form .step-header .remove-step:hover{background-color:#e64a4a}.recipe-form .step-fields{display:grid;grid-template-columns:1fr 60px 1fr;gap:.5rem}.recipe-form .step-fields textarea{grid-column:span 3;min-height:60px}.recipe-form .step-fields input[type=number]{width:100%}.recipe-form .step-fields input[type=text]{width:100%}.recipe-form textarea,.recipe-form input[type=text],.recipe-form input[type=number],.recipe-form select{width:100%;margin-bottom:.5rem;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;color:#fff}.recipe-form textarea{min-height:80px}.recipe-form .add-step,.recipe-form .add-ingredient{background-color:#2c7ac8;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer;margin-bottom:1rem;font-weight:bold;transition:background-color .3s}.recipe-form .add-step:hover,.recipe-form .add-ingredient:hover{background-color:hsl(210,63.9344262295%,57.8431372549%)}.recipe-form .submit-button{background-color:#4ecdc4;border:none;padding:.75rem 1.5rem;border-radius:4px;cursor:pointer;font-weight:bold;width:100%;margin-top:2rem;transition:all .3s ease;color:#fff;font-size:1.1rem;position:relative;z-index:1}.recipe-form .submit-button:hover:not(:disabled){background-color:rgb(117.7665198238,216.2334801762,209.2555066079);transform:translateY(-1px)}.recipe-form .submit-button:active:not(:disabled){transform:translateY(1px)}.recipe-form .submit-button:disabled{opacity:.5;cursor:not-allowed;background-color:#666}.recipe-form .submit-button:focus{outline:2px solid #2c7ac8;outline-offset:2px}.recipe-form .step-fields{display:grid;grid-template-columns:1fr 60px 1fr;gap:.5rem}.recipe-form .step-fields .step-textarea{grid-column:1/-1;min-height:60px}.recipe-form .step-fields .step-duration{width:100%;text-align:center}.recipe-form .step-fields .step-note{grid-column:3/-1}.recipe-form .step-time-label{font-size:.8rem;color:hsla(0,0%,100%,.8);margin-bottom:.5rem}.recipe-form .step-description{margin-top:.5rem;padding:.5rem;background-color:rgba(0,0,0,.4);border-left:2px solid #2c7ac8;font-size:.9rem;color:hsl(0,0%,110%)}.ingredient-row{display:flex;gap:.5rem;margin-bottom:.5rem;align-items:center}.ingredient-row input{flex:1;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;color:#fff}.ingredient-row input:nth-child(1){flex:2}.ingredient-row input:nth-child(2){max-width:40px;text-align:center}.ingredient-row input:nth-child(3){max-width:160px}.ingredient-row .remove-ingredient{background:none;border:none;font-size:1.2rem;color:#ff4d4d;cursor:pointer;transition:color .3s ease}.ingredient-row .remove-ingredient:hover{color:#ff1a1a}input[type=number]{appearance:none;-webkit-appearance:none;-moz-appearance:textfield;padding-right:.5rem}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.image-preview-wrapper{position:relative;display:inline-block;margin-top:.5rem}.image-preview{max-width:150px;height:auto;border-radius:8px;box-shadow:0 0 6px rgba(0,0,0,.5);border:1px solid #444}.remove-image{position:absolute;top:-10px;right:-10px;background:#ff4d4d;color:#fff;border:none;font-size:1.2rem;border-radius:50%;cursor:pointer;padding:.3rem .5rem}.remove-image:hover{background:#e64a4a}select{width:100%;padding:.5rem;background-color:#1e1e1e;border:1px solid #2c7ac8;border-radius:4px;color:#fff;font-size:1rem;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url(${p});background-repeat:no-repeat;background-position:right .5rem center;background-size:1.2rem auto}select:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%);background-color:rgba(0,0,0,.5)}.form-group select,.form-group input[type=text],.form-group input[type=number],.form-group textarea{width:100%;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;color:#fff}.form-group select:focus,.form-group input[type=text]:focus,.form-group input[type=number]:focus,.form-group textarea:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%);background-color:hsla(0,0%,100%,.15)}`,""]);const d=s},7274:(e,r,t)=>{t.r(r),t.d(r,{default:()=>R});var o=t(4848),n=t(6540),i=t(4126),a=t(5072),l=t.n(a),c=t(7825),u=t.n(c),s=t(7659),p=t.n(s),d=t(5056),m=t.n(d),f=t(540),g=t.n(f),b=t(1113),h=t.n(b),x=t(7272),v={};v.styleTagTransform=h(),v.setAttributes=m(),v.insert=p().bind(null,"head"),v.domAPI=u(),v.insertStyleElement=g(),l()(x.A,v),x.A&&x.A.locals&&x.A.locals;var y=function(){return y=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},y.apply(this,arguments)},w=function(e,r,t){if(t||2===arguments.length)for(var o,n=0,i=r.length;n<i;n++)!o&&n in r||(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return e.concat(o||Array.prototype.slice.call(r))};const j=function(e){var r=e.onSubmit,t=(0,n.useState)("breakfast"),a=t[0],l=t[1],c=(0,n.useState)(""),u=c[0],s=c[1],p=(0,n.useState)(""),d=p[0],m=p[1],f=(0,n.useState)(0),g=f[0],b=f[1],h=(0,n.useState)(3),x=h[0],v=h[1],j=(0,n.useState)([{text:"",note:"",duration:void 0}]),k=j[0],N=j[1],C=(0,n.useState)([{name:"",amount:0,unit:""}]),S=C[0],z=C[1],A=(0,n.useState)("/images/recipes/default.jpg"),R=A[0],O=A[1],T=function(e,r,t){var o=w([],k,!0);"text"===r||"note"===r?o[e][r]=t:"duration"===r&&(o[e].duration=Math.max(0,Number(t))),N(o)},q=function(e,r,t){var o=w([],S,!0);"name"===r||"unit"===r?o[e][r]=t:"amount"===r&&(o[e].amount=Math.max(0,Number(t))),z(o)},M=function(e){if(console.log("1. Начало отправки формы"),e.preventDefault(),console.log("2. preventDefault выполнен"),console.log("3. Текущие значения формы:",{title:u.trim(),totalTime:g,stepsValid:k.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0})),steps:k.map((function(e){return{text:e.text,duration:e.duration,isValid:""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}}))}),""===u.trim()||!g||k.some((function(e){return""===e.text.trim()||void 0===e.duration||e.duration<=0})))return console.log("4. Валидация не пройдена"),alert("Заполните все обязательные поля");console.log("5. Валидация пройдена, вызываем onSubmit");try{r(a,u,d,g,x,S.filter((function(e){return""!==e.name.trim()})),k.map((function(e,r){return y(y({},e),{number:r+1})})),R||"/images/recipes/default.jpg"),console.log("6. onSubmit выполнен успешно")}catch(e){console.error("7. Ошибка при выполнении onSubmit:",e)}},V=""!==u.trim()&&g>0&&k.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}));return console.log("canSubmit:",V,{titleValid:""!==u.trim(),timeValid:g>0,stepsValid:k.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0})),steps:k.map((function(e){return{text:e.text,duration:e.duration,isValid:""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}}))}),(0,o.jsxs)("form",{className:"recipe-form",onSubmit:function(e){console.log("Form submit event"),M(e)},onMouseDown:function(e){console.log("Form mousedown event")},onClick:function(e){console.log("Form click event")},children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Тип рецепта"}),(0,o.jsx)("select",{value:a,onChange:function(e){return l(e.target.value)},required:!0,style:{color:"#ccc",backgroundColor:"#1e1e1e",padding:"0.5rem",fontSize:"1rem",border:"1px solid var(--primary-color)",borderRadius:"4px"},children:i.D.map((function(e){return(0,o.jsx)("option",{value:e.value,children:e.label},e.value)}))})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Название"}),(0,o.jsx)("input",{type:"text",value:u,onChange:function(e){return s(e.target.value)},maxLength:127,placeholder:"Например: Омлет с овощами",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Описание"}),(0,o.jsx)("textarea",{value:d,onChange:function(e){return m(e.target.value)},placeholder:"Краткое описание рецепта"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Общее время приготовления (мин)"}),(0,o.jsx)("input",{type:"number",value:g,onChange:function(e){return b(Math.max(0,Number(e.target.value)))},min:"1",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Сложность"}),(0,o.jsxs)("select",{value:x,onChange:function(e){return v(Number(e.target.value))},required:!0,style:{color:"#ccc",backgroundColor:"#1e1e1e",padding:"0.5rem",fontSize:"1rem",border:"1px solid var(--primary-color)",borderRadius:"4px"},children:[(0,o.jsx)("option",{value:1,children:"1 — Очень легко"}),(0,o.jsx)("option",{value:2,children:"2 — Легко"}),(0,o.jsx)("option",{value:3,children:"3 — Среднее"}),(0,o.jsx)("option",{value:4,children:"4 — Сложно"}),(0,o.jsx)("option",{value:5,children:"5 — Очень сложно"})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Фото блюда (URL)"}),(0,o.jsx)("input",{type:"text",placeholder:"https://example.com/image.jpg",value:R,onChange:function(e){var r=e.target.value;O(r)}})]}),R&&(0,o.jsxs)("div",{className:"form-group image-preview-wrapper",children:[(0,o.jsx)("img",{src:R,alt:"Предпросмотр",className:"image-preview"}),(0,o.jsx)("button",{type:"button",className:"remove-image",onClick:function(){return O("")},children:"×"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Ингредиенты на одну порцию"}),S.map((function(e,r){return(0,o.jsxs)("div",{className:"ingredient-row",children:[(0,o.jsx)("input",{type:"text",placeholder:"Название",value:e.name,onChange:function(e){return q(r,"name",e.target.value)}}),(0,o.jsx)("input",{type:"number",placeholder:"Количество",value:e.amount,onChange:function(e){return q(r,"amount",Number(e.target.value))},min:"0"}),(0,o.jsx)("input",{type:"text",placeholder:"Единицы измерения",value:e.unit,onChange:function(e){return q(r,"unit",e.target.value)}}),S.length>1&&(0,o.jsx)("button",{type:"button",className:"remove-ingredient",onClick:function(){return function(e){if(S.length>1){var r=w([],S,!0);r.splice(e,1),z(r)}}(r)},children:"×"})]},r)})),(0,o.jsx)("button",{type:"button",onClick:function(){z(w(w([],S,!0),[{name:"",amount:0,unit:""}],!1))},className:"add-ingredient",children:"+ Добавить ингредиент"})]}),(0,o.jsx)("div",{className:"steps-container",children:k.map((function(e,r){var t;return(0,o.jsxs)("div",{className:"step",children:[(0,o.jsxs)("div",{className:"step-header",children:[(0,o.jsxs)("h4",{children:["Шаг ",r+1]}),k.length>1&&(0,o.jsx)("button",{type:"button",onClick:function(){return function(e){if(k.length>1){var r=w([],k,!0);r.splice(e,1),N(r)}}(r)},className:"remove-step",children:"Удалить"})]}),(0,o.jsx)("textarea",{value:e.text,onChange:function(e){return T(r,"text",e.target.value)},placeholder:"Описание шага",required:!0}),(0,o.jsx)("input",{type:"number",value:null!==(t=e.duration)&&void 0!==t?t:"",onChange:function(e){return T(r,"duration",Math.max(0,Number(e.target.value)))},placeholder:"Время (мин)",min:"0",required:!0}),(0,o.jsx)("input",{type:"text",value:e.note||"",onChange:function(e){return T(r,"note",e.target.value)},placeholder:"Примечание (необязательно)"})]},r)}))}),(0,o.jsx)("button",{type:"button",onClick:function(){N(w(w([],k,!0),[{text:"",note:"",duration:void 0}],!1))},className:"add-step",children:"Добавить шаг"}),(0,o.jsx)("button",{type:"button",disabled:!V,className:"submit-button",onClick:function(e){console.log("Клик по кнопке отправки"),console.log("Состояние canSubmit:",V),console.log("Состояние кнопки disabled:",!V),V&&M(new Event("submit"))},children:"Сохранить рецепт"})]})};var k=t(7665),N=t(7793),C=t(7900),S=t(6950),z={};z.styleTagTransform=h(),z.setAttributes=m(),z.insert=p().bind(null,"head"),z.domAPI=u(),z.insertStyleElement=g(),l()(S.A,z),S.A&&S.A.locals&&S.A.locals;var A=function(){return A=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},A.apply(this,arguments)};const R=function(){var e=(0,C.A)().user,r=(0,k.Zp)();return(0,o.jsxs)("div",{className:"new-recipe-page",children:[(0,o.jsx)("h2",{children:"Создание нового рецепта"}),(0,o.jsx)(j,{onSubmit:function(t,o,n,i,a,l,c,u){return s=void 0,p=void 0,m=function(){var s,p;return function(e,r){var t,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(i=0)),i;)try{if(t=1,o&&(n=2&l[0]?o.return:l[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,l[1])).done)return n;switch(o=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(6===l[0]&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=r.call(e,i)}catch(e){l=[6,e],o=0}finally{t=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}}(this,(function(d){if(console.log("NewRecipe: handleSubmit начало выполнения"),!e)return console.error("NewRecipe: Пользователь не авторизован"),alert("Необходимо авторизоваться для создания рецепта"),[2];try{s={title:o,type:t,description:n,totalTime:i,difficulty:a,ingredients:l,steps:c.map((function(e,r){return A(A({},e),{number:r+1})})),image:u,author:e.email,savedBy:[]},console.log("NewRecipe: Подготовленные данные рецепта:",s),p=(0,N.zs)(s),console.log("NewRecipe: Рецепт успешно создан:",p),console.log("NewRecipe: Текущее состояние mockRecipes:",N.s_),setTimeout((function(){console.log("NewRecipe: Попытка перехода на главную"),r("/",{replace:!0}),console.log("NewRecipe: Команда перехода выполнена")}),100)}catch(e){console.error("NewRecipe: Ошибка при создании рецепта:",e),alert("Произошла ошибка при создании рецепта. Пожалуйста, попробуйте снова.")}return[2]}))},new((d=void 0)||(d=Promise))((function(e,r){function t(e){try{n(m.next(e))}catch(e){r(e)}}function o(e){try{n(m.throw(e))}catch(e){r(e)}}function n(r){var n;r.done?e(r.value):(n=r.value,n instanceof d?n:new d((function(e){e(n)}))).then(t,o)}n((m=m.apply(s,p||[])).next())}));var s,p,d,m}})]})}}}]);