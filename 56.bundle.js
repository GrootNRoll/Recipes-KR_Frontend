"use strict";(self.webpackChunkrecipe_app=self.webpackChunkrecipe_app||[]).push([[56],{2056:(e,r,t)=>{t.r(r),t.d(r,{default:()=>T});var o=t(4848),n=t(6540),i=t(4126),a=t(5072),c=t.n(a),l=t(7825),p=t.n(l),u=t(7659),s=t.n(u),m=t(5056),d=t.n(m),f=t(540),g=t.n(f),b=t(1113),h=t.n(b),x=t(5451),v={};v.styleTagTransform=h(),v.setAttributes=d(),v.insert=s().bind(null,"head"),v.domAPI=p(),v.insertStyleElement=g(),c()(x.A,v),x.A&&x.A.locals&&x.A.locals;var w=t(1491),y=function(){return y=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},y.apply(this,arguments)},j=function(e,r,t){if(t||2===arguments.length)for(var o,n=0,i=r.length;n<i;n++)!o&&n in r||(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return e.concat(o||Array.prototype.slice.call(r))},k=(0,w.O)("images/recipes/default.jpg");const N=function(e){var r=e.onSubmit,t=e.initialData,a=(0,n.useState)("breakfast"),c=a[0],l=a[1],p=(0,n.useState)(""),u=p[0],s=p[1],m=(0,n.useState)(""),d=m[0],f=m[1],g=(0,n.useState)(0),b=g[0],h=g[1],x=(0,n.useState)(3),v=x[0],w=x[1],N=(0,n.useState)([{text:"",note:"",duration:void 0}]),C=N[0],S=N[1],z=(0,n.useState)([{name:"",amount:0,unit:""}]),A=z[0],R=z[1],O=(0,n.useState)((null==t?void 0:t.image)||""),T=O[0],q=O[1],D=T||k,M=function(e,r,t){var o=j([],C,!0);"text"===r||"note"===r?o[e][r]=t:"duration"===r&&(o[e].duration=Math.max(0,Number(t))),S(o)},V=function(e,r,t){var o=j([],A,!0);"name"===r||"unit"===r?o[e][r]=t:"amount"===r&&(o[e].amount=Math.max(0,Number(t))),R(o)},P=function(e){if(console.log("1. Начало отправки формы"),e.preventDefault(),console.log("2. preventDefault выполнен"),console.log("3. Текущие значения формы:",{title:u.trim(),totalTime:b,stepsValid:C.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0})),steps:C.map((function(e){return{text:e.text,duration:e.duration,isValid:""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}}))}),""===u.trim()||!b||C.some((function(e){return""===e.text.trim()||void 0===e.duration||e.duration<=0})))return console.log("4. Валидация не пройдена"),alert("Заполните все обязательные поля");console.log("5. Валидация пройдена, вызываем onSubmit");try{r(c,u,d,b,v,A.filter((function(e){return""!==e.name.trim()})),C.map((function(e,r){return y(y({},e),{number:r+1})})),T||"/images/recipes/default.jpg"),console.log("6. onSubmit выполнен успешно")}catch(e){console.error("7. Ошибка при выполнении onSubmit:",e)}},E=""!==u.trim()&&b>0&&C.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}));return console.log("canSubmit:",E,{titleValid:""!==u.trim(),timeValid:b>0,stepsValid:C.every((function(e){return""!==e.text.trim()&&void 0!==e.duration&&e.duration>0})),steps:C.map((function(e){return{text:e.text,duration:e.duration,isValid:""!==e.text.trim()&&void 0!==e.duration&&e.duration>0}}))}),(0,o.jsxs)("form",{className:"recipe-form",onSubmit:function(e){console.log("Form submit event"),P(e)},onMouseDown:function(e){console.log("Form mousedown event")},onClick:function(e){console.log("Form click event")},children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Тип рецепта"}),(0,o.jsx)("select",{value:c,onChange:function(e){return l(e.target.value)},required:!0,style:{color:"#ccc",backgroundColor:"#1e1e1e",padding:"0.5rem",fontSize:"1rem",border:"1px solid var(--primary-color)",borderRadius:"4px"},children:i.D.map((function(e){return(0,o.jsx)("option",{value:e.value,children:e.label},e.value)}))})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Название"}),(0,o.jsx)("input",{type:"text",value:u,onChange:function(e){return s(e.target.value)},maxLength:127,placeholder:"Например: Омлет с овощами",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Описание"}),(0,o.jsx)("textarea",{value:d,onChange:function(e){return f(e.target.value)},placeholder:"Краткое описание рецепта"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Общее время приготовления (мин)"}),(0,o.jsx)("input",{type:"number",value:b,onChange:function(e){return h(Math.max(0,Number(e.target.value)))},min:"1",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Сложность"}),(0,o.jsxs)("select",{value:v,onChange:function(e){return w(Number(e.target.value))},required:!0,style:{color:"#ccc",backgroundColor:"#1e1e1e",padding:"0.5rem",fontSize:"1rem",border:"1px solid var(--primary-color)",borderRadius:"4px"},children:[(0,o.jsx)("option",{value:1,children:"1 — Очень легко"}),(0,o.jsx)("option",{value:2,children:"2 — Легко"}),(0,o.jsx)("option",{value:3,children:"3 — Среднее"}),(0,o.jsx)("option",{value:4,children:"4 — Сложно"}),(0,o.jsx)("option",{value:5,children:"5 — Очень сложно"})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Фото блюда (URL)"}),(0,o.jsx)("input",{type:"text",placeholder:"https://example.com/image.jpg",value:T,onChange:function(e){var r=e.target.value;q(r)}})]}),T&&(0,o.jsxs)("div",{className:"form-group image-preview-wrapper",children:[(0,o.jsx)("img",{src:D,alt:"Предпросмотр",className:"image-preview"}),(0,o.jsx)("button",{type:"button",className:"remove-image",onClick:function(){return q("")},children:"×"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Ингредиенты на одну порцию"}),A.map((function(e,r){return(0,o.jsxs)("div",{className:"ingredient-row",children:[(0,o.jsx)("input",{type:"text",placeholder:"Название",value:e.name,onChange:function(e){return V(r,"name",e.target.value)}}),(0,o.jsx)("input",{type:"number",placeholder:"Количество",value:e.amount,onChange:function(e){return V(r,"amount",Number(e.target.value))},min:"0"}),(0,o.jsx)("input",{type:"text",placeholder:"Единицы измерения",value:e.unit,onChange:function(e){return V(r,"unit",e.target.value)}}),A.length>1&&(0,o.jsx)("button",{type:"button",className:"remove-ingredient",onClick:function(){return function(e){if(A.length>1){var r=j([],A,!0);r.splice(e,1),R(r)}}(r)},children:"×"})]},r)})),(0,o.jsx)("button",{type:"button",onClick:function(){R(j(j([],A,!0),[{name:"",amount:0,unit:""}],!1))},className:"add-ingredient",children:"+ Добавить ингредиент"})]}),(0,o.jsx)("div",{className:"steps-container",children:C.map((function(e,r){var t;return(0,o.jsxs)("div",{className:"step",children:[(0,o.jsxs)("div",{className:"step-header",children:[(0,o.jsxs)("h4",{children:["Шаг ",r+1]}),C.length>1&&(0,o.jsx)("button",{type:"button",onClick:function(){return function(e){if(C.length>1){var r=j([],C,!0);r.splice(e,1),S(r)}}(r)},className:"remove-step",children:"Удалить"})]}),(0,o.jsx)("textarea",{value:e.text,onChange:function(e){return M(r,"text",e.target.value)},placeholder:"Описание шага",required:!0}),(0,o.jsx)("input",{type:"number",value:null!==(t=e.duration)&&void 0!==t?t:"",onChange:function(e){return M(r,"duration",Math.max(0,Number(e.target.value)))},placeholder:"Время (мин)",min:"0",required:!0}),(0,o.jsx)("input",{type:"text",value:e.note||"",onChange:function(e){return M(r,"note",e.target.value)},placeholder:"Примечание (необязательно)"})]},r)}))}),(0,o.jsx)("button",{type:"button",onClick:function(){S(j(j([],C,!0),[{text:"",note:"",duration:void 0}],!1))},className:"add-step",children:"Добавить шаг"}),(0,o.jsx)("button",{type:"button",disabled:!E,className:"submit-button",onClick:function(e){console.log("Клик по кнопке отправки"),console.log("Состояние canSubmit:",E),console.log("Состояние кнопки disabled:",!E),E&&P(new Event("submit"))},children:"Сохранить рецепт"})]})};var C=t(7665),S=t(7793),z=t(7900),A=t(4343),R={};R.styleTagTransform=h(),R.setAttributes=d(),R.insert=s().bind(null,"head"),R.domAPI=p(),R.insertStyleElement=g(),c()(A.A,R),A.A&&A.A.locals&&A.A.locals;var O=function(){return O=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},O.apply(this,arguments)};const T=function(){var e=(0,z.A)().user,r=(0,C.Zp)();return(0,o.jsxs)("div",{className:"new-recipe-page",children:[(0,o.jsx)("h2",{children:"Создание нового рецепта"}),(0,o.jsx)(N,{onSubmit:function(t,o,n,i,a,c,l,p){return u=void 0,s=void 0,d=function(){var u,s;return function(e,r){var t,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(t=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((n=(n=i.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){i.label=c[1];break}if(6===c[0]&&i.label<n[1]){i.label=n[1],n=c;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(c);break}n[2]&&i.ops.pop(),i.trys.pop();continue}c=r.call(e,i)}catch(e){c=[6,e],o=0}finally{t=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(m){if(console.log("NewRecipe: handleSubmit начало выполнения"),!e)return console.error("NewRecipe: Пользователь не авторизован"),alert("Необходимо авторизоваться для создания рецепта"),[2];try{u={title:o,type:t,description:n,totalTime:i,difficulty:a,ingredients:c,steps:l.map((function(e,r){return O(O({},e),{number:r+1})})),image:p,author:e.email,savedBy:[]},console.log("NewRecipe: Подготовленные данные рецепта:",u),s=(0,S.zs)(u),console.log("NewRecipe: Рецепт успешно создан:",s),console.log("NewRecipe: Текущее состояние mockRecipes:",S.s_),setTimeout((function(){console.log("NewRecipe: Попытка перехода на главную"),r("/",{replace:!0}),console.log("NewRecipe: Команда перехода выполнена")}),100)}catch(e){console.error("NewRecipe: Ошибка при создании рецепта:",e),alert("Произошла ошибка при создании рецепта. Пожалуйста, попробуйте снова.")}return[2]}))},new((m=void 0)||(m=Promise))((function(e,r){function t(e){try{n(d.next(e))}catch(e){r(e)}}function o(e){try{n(d.throw(e))}catch(e){r(e)}}function n(r){var n;r.done?e(r.value):(n=r.value,n instanceof m?n:new m((function(e){e(n)}))).then(t,o)}n((d=d.apply(u,s||[])).next())}));var u,s,m,d}})]})}},4126:(e,r,t)=>{t.d(r,{D:()=>o});var o=[{value:"breakfast",label:"Завтрак"},{value:"lunch",label:"Обед"},{value:"dinner",label:"Ужин"},{value:"other",label:"Другое"}]},4343:(e,r,t)=>{t.d(r,{A:()=>c});var o=t(1601),n=t.n(o),i=t(6314),a=t.n(i)()(n());a.push([e.id,".new-recipe-page{max-width:1200px;margin:0 auto;padding:2rem}.new-recipe-page h2{margin-bottom:1.5rem;color:#2c7ac8;cursor:default}",""]);const c=a},5278:e=>{e.exports="data:image/svg+xml;utf8,<svg fill=%27white%27 height=%2724%27 viewBox=%270 0 24 24%27 width=%2724%27 xmlns=%27http://www.w3.org/2000/svg%27><path d=%27M7 10l5 5 5-5z%27/></svg>"},5451:(e,r,t)=>{t.d(r,{A:()=>m});var o=t(1601),n=t.n(o),i=t(6314),a=t.n(i),c=t(4417),l=t.n(c),p=new URL(t(5278),t.b),u=a()(n()),s=l()(p);u.push([e.id,`.recipe-form{max-width:800px;margin:0 auto;padding:2rem;background:rgba(0,0,0,.3);border-radius:8px}@media(max-width: 768px){.recipe-form{padding:1.5rem}}@media(max-width: 576px){.recipe-form{padding:1rem}}.recipe-form input,.recipe-form textarea,.recipe-form select{user-select:text;color:#fff}.recipe-form .form-group{margin-bottom:1.5rem}@media(max-width: 576px){.recipe-form .form-group{margin-bottom:1rem}}.recipe-form .form-group label{display:block;margin-bottom:.5rem;color:#fff;font-weight:bold}@media(max-width: 576px){.recipe-form .form-group label{font-size:.9rem;margin-bottom:.3rem}}.recipe-form .form-group input[type=text],.recipe-form .form-group input[type=number],.recipe-form .form-group textarea,.recipe-form .form-group select{width:100%;padding:.8rem;background:rgba(0,0,0,.2);border:1px solid #2c7ac8;border-radius:4px;color:#fff;font-size:1rem}@media(max-width: 576px){.recipe-form .form-group input[type=text],.recipe-form .form-group input[type=number],.recipe-form .form-group textarea,.recipe-form .form-group select{padding:.6rem;font-size:.9rem}}.recipe-form .form-group input[type=text]:focus,.recipe-form .form-group input[type=number]:focus,.recipe-form .form-group textarea:focus,.recipe-form .form-group select:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%)}.recipe-form .form-group textarea{min-height:100px;resize:vertical}.recipe-form .recipe-description{margin-top:-1rem;margin-bottom:1.5rem;font-size:1rem;color:hsl(0,0%,130%);line-height:1.6;opacity:.9}.recipe-form .steps-container{margin:2rem 0}.recipe-form .step{background:rgba(0,0,0,.2);border-radius:4px;padding:1rem;margin-bottom:1rem}@media(max-width: 576px){.recipe-form .step{padding:.8rem}}.recipe-form .step .step-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}.recipe-form .step .step-header h4{margin:0;color:#2c7ac8}@media(max-width: 576px){.recipe-form .step .step-header h4{font-size:.9rem}}.recipe-form .step .step-header .remove-step{background:none;border:none;color:#f44;cursor:pointer;padding:.3rem .6rem;font-size:.9rem}.recipe-form .step .step-header .remove-step:hover{color:#f66}.recipe-form .step textarea,.recipe-form .step input{margin-bottom:.5rem}.recipe-form .step textarea:last-child,.recipe-form .step input:last-child{margin-bottom:0}.recipe-form .step-fields{display:grid;grid-template-columns:1fr 60px 1fr;gap:.5rem}.recipe-form .step-fields textarea{grid-column:span 3;min-height:60px}.recipe-form .step-fields input[type=number]{width:100%}.recipe-form .step-fields input[type=text]{width:100%}.recipe-form textarea,.recipe-form input[type=text],.recipe-form input[type=number],.recipe-form select{width:100%;margin-bottom:.5rem;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;color:#fff}.recipe-form textarea{min-height:80px}.recipe-form .add-step,.recipe-form .add-ingredient{background-color:#2c7ac8;border:none;padding:.5rem 1rem;border-radius:4px;cursor:pointer;margin-bottom:1rem;font-weight:bold;transition:background-color .3s}.recipe-form .add-step:hover,.recipe-form .add-ingredient:hover{background-color:hsl(210,63.9344262295%,57.8431372549%)}.recipe-form .submit-button{background-color:#4ecdc4;border:none;padding:.75rem 1.5rem;border-radius:4px;cursor:pointer;font-weight:bold;width:100%;margin-top:2rem;transition:all .3s ease;color:#fff;font-size:1.1rem;position:relative;z-index:1}.recipe-form .submit-button:hover:not(:disabled){background-color:rgb(117.7665198238,216.2334801762,209.2555066079);transform:translateY(-1px)}.recipe-form .submit-button:active:not(:disabled){transform:translateY(1px)}.recipe-form .submit-button:disabled{opacity:.5;cursor:not-allowed;background-color:#666}.recipe-form .submit-button:focus{outline:2px solid #2c7ac8;outline-offset:2px}.recipe-form .step-fields{display:grid;grid-template-columns:1fr 60px 1fr;gap:.5rem}.recipe-form .step-fields .step-textarea{grid-column:1/-1;min-height:60px}.recipe-form .step-fields .step-duration{width:100%;text-align:center}.recipe-form .step-fields .step-note{grid-column:3/-1}.recipe-form .step-time-label{font-size:.8rem;color:hsla(0,0%,100%,.8);margin-bottom:.5rem}.recipe-form .step-description{margin-top:.5rem;padding:.5rem;background-color:rgba(0,0,0,.4);border-left:2px solid #2c7ac8;font-size:.9rem;color:hsl(0,0%,110%)}.ingredient-row{display:grid;grid-template-columns:2fr 1fr 1fr auto;gap:1rem;margin-bottom:.5rem}@media(max-width: 768px){.ingredient-row{gap:.5rem}}@media(max-width: 576px){.ingredient-row{grid-template-columns:1fr;gap:.3rem}}.ingredient-row input{width:100%}.ingredient-row .remove-ingredient{background:none;border:none;color:#f44;cursor:pointer;font-size:1.2rem;padding:0;display:flex;align-items:center;justify-content:center;width:30px;height:30px}@media(max-width: 576px){.ingredient-row .remove-ingredient{align-self:flex-end}}.ingredient-row .remove-ingredient:hover{color:#f66}input[type=number]{appearance:none;-webkit-appearance:none;-moz-appearance:textfield;padding-right:.5rem}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.image-preview-wrapper{position:relative;display:inline-block;margin-top:.5rem}.image-preview{max-width:150px;height:auto;border-radius:8px;box-shadow:0 0 6px rgba(0,0,0,.5);border:1px solid #444}.remove-image{position:absolute;top:-10px;right:-10px;background:#ff4d4d;color:#fff;border:none;font-size:1.2rem;border-radius:50%;cursor:pointer;padding:.3rem .5rem}.remove-image:hover{background:#e64a4a}select{width:100%;padding:.5rem;background-color:#1e1e1e;border:1px solid #2c7ac8;border-radius:4px;color:#fff;font-size:1rem;-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url(${s});background-repeat:no-repeat;background-position:right .5rem center;background-size:1.2rem auto}select:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%);background-color:rgba(0,0,0,.5)}.form-group select,.form-group input[type=text],.form-group input[type=number],.form-group textarea{width:100%;padding:.5rem;background-color:hsla(0,0%,100%,.1);border:1px solid #2c7ac8;border-radius:4px;color:#fff}.form-group select:focus,.form-group input[type=text]:focus,.form-group input[type=number]:focus,.form-group textarea:focus{outline:none;border-color:hsl(210,63.9344262295%,57.8431372549%);background-color:hsla(0,0%,100%,.15)}`,""]);const m=u}}]);